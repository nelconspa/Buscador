import{a as b}from"./axios-Cm0UX6qg.js";import{u as E,r as h,e as I}from"./index-DPsoc6xT.js";import{_ as v,a as n,b as u,c as y,w as i,d as C,b0 as T,f as p,t as w,h as e,e as t}from"./index-BlFMA_Ff.js";const{Axios:ao,AxiosError:$,CanceledError:co,isCancel:mo,CancelToken:uo,VERSION:po,all:fo,Cancel:_o,isAxiosError:go,spread:ho,toFormData:bo,AxiosHeaders:vo,HttpStatusCode:Co,formToJSON:wo,getAdapter:ko,mergeConfig:xo}=b,B={name:"SubmitButton",props:["title","isSendingForm"]},V={key:0,class:"spinner-border spinner-border-sm",role:"status"},F=e("span",{class:"visually-hidden"},"Loading...",-1),L=[F];function A(s,o,l,a,r,c){const m=n("CButton");return u(),y(m,{color:"dark",type:"submit",class:""},{default:i(()=>[l.isSendingForm?(u(),C("div",V,L)):T("",!0),p(" "+w(l.title),1)]),_:1})}const N=v(B,[["render",A]]),M=""+new URL("logo-tc-CuYuHDjL.jpg",import.meta.url).href,U=""+new URL("tc_2-z7Sgps2U.png",import.meta.url).href,G={name:"Login",setup(){return{v$:E(),logoTC:M,sideLoginImage:U}},components:{SubmitButton:N},data(){return{form:{username:"",password:""},errorMsg:"",showError:!1,isSendingForm:!1}},validations(){return{form:{username:{required:h,email:I},password:{required:h}}}},methods:{setTouched(s){(s=="username"||s=="all")&&this.v$.form.username.$touch(),(s=="password"||s=="all")&&this.v$.form.password.$touch()},handleErrors(s){console.log("Error: ",s),this.showError=!0;const o=s.response.status;s instanceof $&&s.response?o==404?this.errorMsg="No se encontró el recurso solicitado.":o==401?this.errorMsg="Email y/o Contraseña inválida.":o==500&&(this.errorMsg="Error del servidor: Ha ocurrido un error interno en el servidor."):s.request?this.errorMsg="No se recibió respuesta del servidor.":this.errorMsg="Ha ocurrido un error: "+s,this.isSendingForm=!1},onSubmit(s){console.log("se apreto el boton de submit"),s.preventDefault(),this.setTouched("all"),this.v$.$invalid||(this.isSendingForm=!0,console.log("deberia estar en login"),b.post(this.$store.state.backendUrl+"/login",this.form,{headers:{"Content-Type":"application/json",Authorization:"Bearer "+this.$store.state.token}}).then(o=>{let l=o.data;console.log("RESP: ",l),this.$store.commit("saveLogin",{token:l.access_token,name:l.name}),this.$router.push("/"),this.isSendingForm=!1}).catch(o=>{this.handleErrors(o)}))}}},H={class:"vh-100 backG"},j={class:"container py-5 h-100"},D={class:"row d-flex justify-content-center align-items-center h-100"},R={class:"col col-xl-10"},z={class:"card",style:{"border-radius":"1rem"}},q={class:"row g-0"},O={class:"col-md-6 col-lg-5 d-none d-md-block"},J=["src"],P={class:"col-md-6 col-lg-7 d-flex align-items-center"},Y={class:"card-body p-4 p-lg-5 text-black"},K={class:"d-flex align-items-center mb-3 pb-1"},Q=["src"],W=e("span",{style:{"font-family":'"Montserrat", sans-serif !important'},class:"h1 fw-bold mb-0"},"Tribunal Constitucional",-1),X=e("h5",{class:"fw-normal mb-3 pb-3 pt-4",style:{"letter-spacing":"1px"}},"Inicio de sesión Buscador",-1),Z={class:"form-outline mb-4"},oo=e("label",{class:"form-label",for:"Usuario"},"Email",-1),eo={class:"form-outline mb-4"},so=e("label",{class:"form-label",for:"Clave"},"Contraseña",-1),to={class:"pt-2 mb-4 d-grid gap-2 col-6"};function ro(s,o,l,a,r,c){const m=n("CIcon"),f=n("CInputGroupText"),_=n("CFormInput"),g=n("CInputGroup"),k=n("CButton"),x=n("CForm"),S=n("CAlert");return u(),C("section",H,[e("div",j,[e("div",D,[e("div",R,[e("div",z,[e("div",q,[e("div",O,[e("img",{src:a.sideLoginImage,alt:"login form",class:"img-fluid",style:{"border-radius":"1rem 0 0 1rem"}},null,8,J)]),e("div",P,[e("div",Y,[t(x,{onSubmit:c.onSubmit},{default:i(()=>[e("div",K,[e("img",{class:"img-fluid logo_main",src:a.logoTC},null,8,Q),W]),X,e("div",Z,[oo,t(g,{class:"mb-3"},{default:i(()=>[t(f,null,{default:i(()=>[t(m,{icon:"cil-user"})]),_:1}),t(_,{class:"form-control form-control-lg inputs",modelValue:r.form.username,"onUpdate:modelValue":o[0]||(o[0]=d=>r.form.username=d),modelModifiers:{trim:!0},onInput:o[1]||(o[1]=d=>c.setTouched("username")),type:"email",placeholder:"Email",feedback:"Ingresa un email válido.",invalid:a.v$.form.username.$error,autocomplete:"off"},null,8,["modelValue","invalid"])]),_:1})]),e("div",eo,[so,t(g,{class:"mb-4"},{default:i(()=>[t(f,null,{default:i(()=>[t(m,{icon:"cil-lock-locked"})]),_:1}),t(_,{modelValue:r.form.password,"onUpdate:modelValue":o[2]||(o[2]=d=>r.form.password=d),modelModifiers:{trim:!0},onInput:o[3]||(o[3]=d=>c.setTouched("password")),type:"password",placeholder:"Contraseña",feedback:"Ingrese su contraseña.",invalid:a.v$.form.password.$error,class:"form-control form-control-lg inputs",autocomplete:"off"},null,8,["modelValue","invalid"])]),_:1})]),e("div",to,[t(k,{class:"custom-button",color:"dark",size:"lg",onClick:c.onSubmit},{default:i(()=>[p(" Ingresar ")]),_:1},8,["onClick"])])]),_:1},8,["onSubmit"]),t(S,{color:"danger",visible:r.showError,dismissible:"",onClose:o[4]||(o[4]=()=>{r.showError=!1})},{default:i(()=>[p(w(r.errorMsg),1)]),_:1},8,["visible"])])])])])])])])])}const So=v(G,[["render",ro]]);export{So as default};
